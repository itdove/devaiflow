{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://devaiflow.dev/schemas/backends/jira.schema.json",
  "title": "JIRA Backend Configuration",
  "description": "JIRA instance-specific backend configuration",
  "type": "object",
  "properties": {
    "url": {
      "type": "string",
      "format": "uri",
      "description": "JIRA instance URL (must use HTTPS)"
    },
    "transitions": {
      "type": "object",
      "description": "Issue transition configurations",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "from": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of statuses this transition applies from"
          },
          "to": {
            "type": "string",
            "description": "Target status for automatic transitions"
          },
          "prompt": {
            "type": "boolean",
            "description": "Whether to prompt user before transition"
          },
          "on_fail": {
            "type": "string",
            "enum": ["warn", "error", "ignore"],
            "description": "Action to take if transition fails"
          },
          "options": {
            "type": ["array", "null"],
            "items": {"type": "string"},
            "description": "Deprecated - transitions now fetched dynamically from JIRA API"
          }
        },
        "required": ["from", "to", "prompt"],
        "additionalProperties": false
      }
    },
    "field_mappings": {
      "type": ["object", "null"],
      "description": "Cached field mappings from JIRA API (creation fields only)",
      "additionalProperties": true
    },
    "field_cache_timestamp": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "ISO timestamp of last field discovery"
    },
    "field_cache_auto_refresh": {
      "type": "boolean",
      "description": "Auto-refresh field mappings when stale",
      "default": true
    },
    "field_cache_max_age_hours": {
      "type": "integer",
      "description": "Maximum age in hours before cache is stale",
      "default": 24,
      "minimum": 1
    },
    "parent_field_mapping": {
      "type": ["object", "null"],
      "description": "Maps issue types to logical field names for parent relationships",
      "additionalProperties": {"type": "string"}
    }
  },
  "required": ["url"],
  "additionalProperties": false
}
